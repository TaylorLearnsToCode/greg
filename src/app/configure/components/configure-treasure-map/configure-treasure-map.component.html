<greg-rollable-table-template
  entryIdentifier="reference"
  (importEvent)="handleImport($event)"
  [persistenceType]="PERSISTENCE_TYPE"
  [tableForm]="treasureMapForm"
>
  <add-entry-form>
    <label>Add Treasure Article</label>
    <section class="add-treasure-article">
      <form [formGroup]="treasureArticleForm">
        <label>Number</label>
        <label>Article</label>
        <label>Article Type</label>
        <greg-dice-rolled-form
          [fromParentForm]="treasureArticleForm"
          identifier="quantity"
        ></greg-dice-rolled-form>
        <input formControlName="name" type="text" />
        <span>
          <select formControlName="type">
            <ng-container *ngFor="let key of treasureArticleTypeKeys">
              <option [value]="key">
                {{ treasureArticleType(key) }}
              </option>
            </ng-container>
          </select>
        </span>
      </form>

      <div class="map-articles-controls">
        <a (click)="saveMapTreasureArticle()">+Add</a>
        <a (click)="resetTreasureArticleForm()">Reset</a>
      </div>

      <div
        class="map-articles-list"
        *ngIf="treasureMapRefList$ | async as treasureMapRefList"
      >
        <ng-container *ngFor="let ref of treasureMapRefList; index as i">
          <a (click)="addSavedMapTreasureReference(ref)">+</a>
          <span> {{ ref.name }} ( {{ treasureArticleType(ref.type) }} ) </span>
          <a class="edit-pencil" (click)="editTreasureMapArticleEntry(ref)"
            >&#x270E;</a
          >
          <a (click)="deleteTreasureMapArticleEntry(ref)">X</a>
        </ng-container>
      </div>

      <div class="map-articles-controls">
        <!-- Do these next -->
        <a>Import</a>
        <a>Export</a>
        <a>Clear</a>
      </div>
    </section>

    <hr />

    <label>Add Magic Item</label>
    <section
      *ngIf="magicItemList$ | async as magicItemList"
      class="add-magic-item"
    >
      <ng-container *ngIf="magicItemList.length; else noItems">
        <div *ngFor="let magicItem of magicItemList; index as i">
          <a (click)="addMagicItem(magicItem)">+Add</a>
          <span class="shift-entry">
            <a (click)="shiftMagicItem(i, 'up')">&uArr;</a>
            <a (click)="shiftMagicItem(i, 'down')">&dArr;</a>
          </span>
          {{ magicItem.name }}
        </div>
      </ng-container>
      <ng-template #noItems>
        <p>No magic items configured.</p>
      </ng-template>
    </section>
  </add-entry-form>
</greg-rollable-table-template>
